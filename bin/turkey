#!/usr/bin/env python

import os
import argparse

parser = argparse.ArgumentParser(description='Turkey job runner')
subparsers = parser.add_subparsers(help='sub-command help', dest='cmd')

# Compile subcommand
compile = subparsers.add_parser('compile', help='Compile specified app', aliases=['c'])
compile.add_argument('app', help='App to compile')

# Data subcommand
data = subparsers.add_parser('data', help='Download and unpack data')
data.add_argument('app', help='App to data for')

args = parser.parse_args()
TURKEY_HOME = os.environ['TURKEY_HOME']

if args.cmd == 'compile':
    cwd = os.getcwd()
    os.chdir('./apps/%s' % args.app)
    os.system('mkdir -p build')
    os.chdir('./build')
    os.system('cmake .. && make')
    os.chdir(cwd)

elif args.cmd == 'data':
    os.system('./bin/data %s' % args.app)
